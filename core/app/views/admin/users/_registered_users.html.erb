<form class="filter well form-search">
  <input type="text" placeholder="Find a user" class="input-large search-query">
</form>

<table class="table table-bordered filterable">
  <thead>
  <tr>
    <th><%= sortable "username", "Username" %></th>
    <th><%= sortable "email", "Email" %></th>
    <th><%= sortable "sign_in_count", "#sign ins" %></th>
    <th><%= sortable "features", "#features" %></th>
    <th>status</th>
    <th><%= sortable "last_sign_in_at", "last seen" %></th>
    <th></th>
  </tr>
  </thead>

  <tbody>
    <% @users.each do |user| %>
      <tr>
        <td><%= user.username %></td>
        <td><%= user.email %></td>
        <td>
          <span class="label label-<%= sign_in_count_class_for user %>"><%= user.sign_in_count || 0 %></span>
        </td>

        <td>
          <span class="label label-<%= features_count_class_for user %>"><%= user.features.count %></span>
        </td>

        <td>
          <% if user.confirmed_at %>
          <span class="label label-info">confirmed</span>
          <% end %>

          <% if user.approved? %>
          <span class="label label-success">approved</span>
          <% end %>
        </td>

        <td><%= user.current_sign_in_at %></td>
        <td>
          <%= link_to "<i class=\"icon-edit\"></i>".html_safe, edit_admin_user_path(user.id) %>
          <% unless user.approved? %>
            <%= link_to "<i class=\"icon-check\"></i>".html_safe,
                        approve_admin_user_path(user.id) ,
                        method: "PUT",
                        remote: true,
                        data: { confirm: "Are you sure you want to approve user #{user.username}?" },
                        class: "approve-user" %>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
