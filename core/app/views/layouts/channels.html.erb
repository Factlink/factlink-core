<% content_for :left_column do %>
  <div class="left-top-x-fade"></div>
  <div class="user-block-container"></div>
  <div class="channel-listing-container"></div>
  <div class="related-channels"></div>
<% end %>

<% content_for :javascript do %>
  <script>
    $(function() {
      Backbone.history.start({pushState:Modernizr.history, silent:true});

      <% if @user %>
        Channels.reset(<%= channels_for_user(@user).map{|ch| Channels::Channel.for(channel: ch,view: self,channel_user: @user) }.to_json.html_safe %>);
        Channels.setUsername("<%= current_user.username %>");
      <% end %>

      <% if @channel && !@channel.new? %>
        window.currentChannel = Channels.get(<%= @channel.id %>);
      <% end %>

      // this should be moved to an initializer
      // however currently we cannot, since this should
      // not be executed on the single fact page.
      $('.potential-backbone').attr('rel', 'backbone');

    });
  </script>
<% end %>

<%= render template: 'layouts/frontend' %>
