var loading_indicator = $( '#fl-loading-indicator' );

// Hide the 'add factlink source' popup
$('#fl-loading-indicator').fadeIn('fast');
$('#fl-sources-popup').fadeOut('fast');

// Clear the input fields
$(':input:visible:not([type=submit])', $('#fl-sources-popup')).val('');

// Change loading icon to Factlink icon after 300ms
setTimeout(function() {
	// Fancy, change to Factlink check icon
	$('>img:first', loading_indicator)
	    .attr('src', '/images/icons/factlink/16.png');
} , 300); // The delay


// Create the newly added Factlink Sub as an element and add it to our list
setTimeout(function() {
	// Create the new Sub item    
	loading_indicator.hide();
	$('>img:first', loading_indicator)
	    .attr('src', '/images/icons/loading-indicator-white.gif');
	
	// Check if any Sub's are in the list already. If not, hide the current
    // message.
	var no_fact_message = $("#no-facts-message");
	
	if (no_fact_message.length > 0) {
		// The message is there, remove it.
		no_fact_message.slideUp(500);
	}

	// Append to ordered list
	$('ol#fl-sources-list').prepend("<%= escape_javascript(render(:partial => 'source_as_li', :locals => { :factlink => @factlink, :parent => @parent } )) %>");
	
} , 1000); // The delay