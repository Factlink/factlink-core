<% channel ||= nil %>
<% modal ||= nil %>

<div class="fact-block" data-fact-id="<%= fact.id %>">
  <% if channel and user_signed_in? %>
    <%= link_to(
      image_tag("client/close-button.png", :class => "close", "style" => "float: right"),
      remove_fact_from_channel_path(current_user, channel.id, fact.id),
      :confirm => "Are you sure you want to remove this fact from your channel?", :remote => true
    )
    %>
  <% end %>
  <% if modal %>
    <%= fact_bubble(fact, nil, modal) %>
  <% else %>
    <%= fact_bubble(fact) %>
  <% end %>
  <div class="evidence-facts">
    <div class="evidence-actions">
      <% if fact.fact_relations.count < 1 and user_signed_in? %>
        <a href="#" class="show-add"><span class="triangle-up"></span>Show evidence</a>
      <% else %>
        <a href="#" class="show-evidence"><span class="triangle-up"></span>Evidence (<%= fact.evidence_count %>)</a>
      <% end %>
    </div>
    
    <div class="evidence-container" <%= show_evidence(@showEvidence) %>>
      <div class="evidence">
        <table class="evidence-list">
          <tbody>
            <% unless fact.fact_relations.count > 0 %>
              <tr class="no-evidence"><td>
                <% if user_signed_in? %>
                  Perhaps you know something that supports or weakens this fact?
                <% else %>
                  There are no facts supporting or weakening this fact at the moment.
                <% end %>
              </td></tr>
            <% else %>
              <tr><td>
                <%= render :partial => "/facts/partial/fact_bubble", 
                  :collection => fact.sorted_fact_relations, :as => :fact_relation, :spacer_template => '/home/snippets/table_row_seperator'
                %>
              </td></tr>
            <% end %>
          </tbody>
        </table>
      </div>
      <div class="potential-evidence" style="display: none;">
        <%= render :partial => "/facts/partial/add_evidence", :locals => { :fact => fact } %>
      </div>

			<% if user_signed_in? %>
      <div class="add-action do-add">
        <a href"#" id="toggle-show-add">Add evidence</a>
      </div>
			<% end %>

      <div class="add-action do-show" style="display:none;">
        <a href"#" id="toggle-show-add">Show evidence</a>
      </div>
    </div>
  </div>
</div>