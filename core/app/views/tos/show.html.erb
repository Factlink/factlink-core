<% content_for :notifications do %>
  <% if can? :sign_tos, current_user %>
    <% if current_user.errors.any? %>
      <div class="alert alert-error">
        <a class="close" data-dismiss="alert">Ã—</a>
        <ul>
        <% current_user.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
        </ul>
      </div>
    <% end %>
  <% end %>
<% end %>

<div id="tos">

  <%= render "terms_of_service" %>

  <% if can? :sign_tos, current_user %>
    <%= form_for(current_user, url: tos_path, method: "POST") do |f| %>

      <%= hidden_field_tag :tos_browser_name %>
      <%= hidden_field_tag :tos_browser_version %>

      <div class="tos_checkbox">
        <%= f.check_box :agrees_tos, required: true %>
        <%= f.label :agrees_tos, "I accept the Terms of Service" %>
      </div>

      <div class="actions">
        <%= f.submit "Next", class: "button button-confirm" %>
      </div>
    <% end %>
  <% else %>

    <% if current_user %>
    <div class="center">
      <%= link_to("Go back to your profile", user_profile_path(current_user)) %>
    </div>
    <% end %>
  <% end %>
</div>

<% content_for :javascript do %>
<script type="text/javascript">
  (function() {
    var tos_browser_name    = "<%= browser.name %>"
    var tos_browser_version = "<%= browser.version %>";

    $('#tos_browser_name').val(tos_browser_name);
    $('#tos_browser_version').val(tos_browser_version);
  })();
</script>
<% end %>
