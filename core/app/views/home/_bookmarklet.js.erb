//IMPORTANT: please use only double quotes to delimit strings
(function(){
  var lib_url = "<%= jslib_url %>",
      min = "<%= '.min' unless ['development'].include?(Rails.env) %>",
      <% if ['development'].include?(Rails.env) %>
        clear_cache = "?" + (new Date()).getTime(),
      <% else %>
        clear_cache = "",
      <% end %>
      head = document.getElementsByTagName("head")[0];

  function createScript(location, onLoad) {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.async = false;
    script.src = location;

    onLoad && (script.onload = onLoad);

    head.insertBefore(script,head.firstChild);
  }

  window.FactlinkConfig = {
    modus: "default",
    api: "<%= FactlinkUI::Application.config.api_url %>",
    lib: lib_url,
    client: "bookmarklet",
    srcPath: "/factlink.core" + min + ".js"
  };

  //load the library
  createScript(lib_url + "/factlink" + min + ".js" + clear_cache, function() {
    createScript(lib_url + "/factlink.start_annotating" + min + ".js" + clear_cache);
    createScript(lib_url + "/factlink.start_highlighting" + min + ".js" + clear_cache);
  });
})();

